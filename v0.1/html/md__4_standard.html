<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>StarNEig User&#39;s Guide: Standard eigenvalue problem</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">StarNEig User&#39;s Guide
   &#160;<span id="projectnumber">v0.1 branch</span>
   </div>
   <div id="projectbrief">A task-based library for solving dense nonsymmetric eigenvalue problems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md__4_standard.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Standard eigenvalue problem </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Given a matrix <img class="formulaInl" alt="$A \in \mathbb R^{n \times n}$" src="form_28.png"/>, the <em>standard eigenvalue problem</em> (SEP) consists of finding <em>eigenvalues</em> <img class="formulaInl" alt="$\lambda_i \in \mathbb C$" src="form_29.png"/> and associated <em>eigenvectors</em> <img class="formulaInl" alt="$0 \neq v_i \in \mathbb C^{n}$" src="form_30.png"/> such that </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ A v_i = \lambda_i v_i, \text{ for } i = 1, 2, \dots, n. \]" src="form_31.png"/>
</p>
<p> The eigenvalues are the <img class="formulaInl" alt="$n$" src="form_8.png"/> (potentially complex) roots of the polynomial <img class="formulaInl" alt="$\text{det}(A - \lambda I) = 0$" src="form_32.png"/> of degree <img class="formulaInl" alt="$n$" src="form_8.png"/>. There is often a full set of <img class="formulaInl" alt="$n$" src="form_8.png"/> linearly independent eigenvectors, but if there are <em>multiple</em> eigenvalues (i.e., if <img class="formulaInl" alt="$\lambda_{i} = \lambda_{j}$" src="form_33.png"/> for some <img class="formulaInl" alt="$i \neq j$" src="form_34.png"/>) then there might not be a full set of independent eigenvectors.</p>
<p>The library provides 12 interface functions for the standard case.</p>
<h2>Hessenberg reduction</h2>
<p>Given a general matrix <img class="formulaInl" alt="$A$" src="form_0.png"/>, the <a class="el" href="group__starneig__sm__sep.html#ga3180b21861b10ebf4016ee15e2f79d82" title="Computes a Hessenberg decomposition of a general matrix. ">starneig_SEP_SM_Hessenberg()</a> and <a class="el" href="group__starneig__dm__sep.html#gab328fae0d50eaab2e35110da6d6812c8" title="Computes a Hessenberg decomposition of a general matrix. ">starneig_SEP_DM_Hessenberg()</a> interface functions compute a Hessenberg decomposition </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ A = U * H * U^T, \]" src="form_35.png"/>
</p>
<p> where <img class="formulaInl" alt="$H$" src="form_2.png"/> is upper Hessenberg and <img class="formulaInl" alt="$U$" src="form_36.png"/> is orthogonal. On exit, <img class="formulaInl" alt="$A$" src="form_0.png"/> is overwritten by <img class="formulaInl" alt="$H$" src="form_2.png"/> and <img class="formulaInl" alt="$Q$" src="form_1.png"/> (which is an orthogonal matrix on entry) is overwritten by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ Q \gets Q * U. \]" src="form_37.png"/>
</p>
<p>This is done in order to greatly accelerate the subsequent computation of a Schur decomposition since when working on <img class="formulaInl" alt="$H$" src="form_2.png"/> of size <img class="formulaInl" alt="$n \times n$" src="form_27.png"/>, the amount of work in each iteration of the QR algorithm is reduced from <img class="formulaInl" alt="$\mathcal{O}(n^3)$" src="form_38.png"/> to <img class="formulaInl" alt="$\mathcal{O}(n^2)$" src="form_39.png"/> flops.</p>
<h2>Schur reduction</h2>
<p>Given a Hessenberg decomposition </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ A = Q * H * Q^T, \]" src="form_40.png"/>
</p>
<p> of a general matrix <img class="formulaInl" alt="$A$" src="form_0.png"/>, the <a class="el" href="group__starneig__sm__sep.html#ga357a2d35c0087d984f69987ac23aedfc" title="Computes a Schur decomposition given a Hessenberg decomposition. ">starneig_SEP_SM_Schur()</a> and <a class="el" href="group__starneig__dm__sep.html#ga84f941b63f8bfee1f7535fc072b186ce" title="Computes a Schur decomposition given a Hessenberg decomposition. ">starneig_SEP_DM_Schur()</a> interface functions compute a Schur decomposition </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ A = Q * ( U * S * U^T ) * Q^T \]" src="form_41.png"/>
</p>
<p> where <img class="formulaInl" alt="$S$" src="form_4.png"/> is upper quasi-triangular with <img class="formulaInl" alt="$1 \times 1$" src="form_42.png"/> and <img class="formulaInl" alt="$2 \times 2$" src="form_6.png"/> blocks on the diagonal (Schur matrix) and <img class="formulaInl" alt="$U$" src="form_36.png"/> is orthogonal. The <img class="formulaInl" alt="$1 \times 1$" src="form_42.png"/> blocks correspond to the real eigenvalues and each <img class="formulaInl" alt="$2 \times 2$" src="form_6.png"/> block corresponds to a pair of complex conjugate eigenvalues. On exit, <img class="formulaInl" alt="$H$" src="form_2.png"/> is overwritten by <img class="formulaInl" alt="$S$" src="form_4.png"/> and <img class="formulaInl" alt="$Q$" src="form_1.png"/> is overwritten by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ Q \gets Q * U. \]" src="form_37.png"/>
</p>
<h2>Eigenvalue reordering</h2>
<p>Given a Schur decomposition </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ A = Q * S * Q^T \]" src="form_43.png"/>
</p>
<p> of a general matrix <img class="formulaInl" alt="$A$" src="form_0.png"/> and a selection of eigenvalues, the <a class="el" href="group__starneig__sm__sep.html#ga03cc4e4c45d6ca0d156a3d70d4b91408" title="Reorders selected eigenvalues to the top left corner of a Schur decomposition. ">starneig_SEP_SM_ReorderSchur()</a> and <a class="el" href="group__starneig__dm__sep.html#ga22daf6b10b6da2750125dce46b663e07" title="Reorders selected eigenvalues to the top left corner of a Schur decomposition. ">starneig_SEP_DM_ReorderSchur()</a> interface functions attempt to compute an updated Schur decomposition </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ A = Q * \left( U * \begin{bmatrix} \hat S_{11} &amp; \hat S_{12} \\ 0 &amp; \hat S_{22} \end{bmatrix} * U^T \right) * Q^T, \]" src="form_44.png"/>
</p>
<p> where the selected eigenvalues appear in <img class="formulaInl" alt="$\hat S_{11}$" src="form_45.png"/>. On exit, <img class="formulaInl" alt="$S$" src="form_4.png"/> is overwritten by <img class="formulaInl" alt="$\hat{S}$" src="form_5.png"/> and <img class="formulaInl" alt="$Q$" src="form_1.png"/> is overwritten by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ Q \gets Q * U. \]" src="form_37.png"/>
</p>
<p>Reordering may in rare cases fail. In such cases the output is guaranteed to be a Schur decomposition and all (if any) selected eigenvalues that are correctly placed are marked in the selection array on exit. Reordering may perturb the eigenvalues and the eigenvalues after reordering are returned.</p>
<h2>Combined reduction to Schur form and eigenvalue reordering</h2>
<p>Given a general matrix <img class="formulaInl" alt="$A$" src="form_0.png"/>, the <a class="el" href="group__starneig__sm__sep.html#ga8e038624fecd9f1abb604bef3eb56d3b" title="Computes a (reordered) Schur decomposition of a general matrix. ">starneig_SEP_SM_Reduce()</a> and <a class="el" href="group__starneig__dm__sep.html#gacda636c9bbb32bb65f03b0797998f1bc" title="Computes a (reordered) Schur decomposition of a general matrix. ">starneig_SEP_DM_Reduce()</a> interface functions compute a (reordered) Schur decomposition </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ A = U * S * U^T. \]" src="form_46.png"/>
</p>
<p> Optionally, the interface functions attempt to reorder selected eigenvalues to the top left corner of the Schur matrix <img class="formulaInl" alt="$S$" src="form_4.png"/>. On exit, <img class="formulaInl" alt="$A$" src="form_0.png"/> is overwritten by <img class="formulaInl" alt="$S$" src="form_4.png"/> and <img class="formulaInl" alt="$Q$" src="form_1.png"/> (which is an orthogonal matrix on entry) is overwritten by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ Q \gets Q * U. \]" src="form_37.png"/>
</p>
<p>Reordering may in rare cases fail. In such cases the output is guaranteed to be a Schur decomposition and all (if any) selected eigenvalues that are correctly placed are marked in the selection array on exit. Reordering may perturb the eigenvalues and the eigenvalues after reordering are returned.</p>
<h2>Eigenvectors</h2>
<p>Given a subset consisting of <img class="formulaInl" alt="$m \leq n$" src="form_47.png"/> of the eigenvalues <img class="formulaInl" alt="$\lambda_{i}$" src="form_48.png"/> for <img class="formulaInl" alt="$i = 1, 2, \ldots, m$" src="form_49.png"/> and a Schur decomposition <img class="formulaInl" alt="$A = Q S Q^{H}$" src="form_50.png"/>, we can compute for each <img class="formulaInl" alt="$\lambda_{i}$" src="form_48.png"/> an <em>eigenvector</em> <img class="formulaInl" alt="$v_{i} \neq 0$" src="form_51.png"/> such that <img class="formulaInl" alt="$A v_{i} = \lambda_{i} v_{i}$" src="form_52.png"/> by first computing an eigenvector <img class="formulaInl" alt="$w_{i}$" src="form_53.png"/> of <img class="formulaInl" alt="$S$" src="form_4.png"/> and then transform it back to the original basis by pre-multiplication with <img class="formulaInl" alt="$Q$" src="form_1.png"/>.</p>
<p>Given a Schur decomposition </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ A = Q * S * Q^T \]" src="form_43.png"/>
</p>
<p> of a general matrix <img class="formulaInl" alt="$A$" src="form_0.png"/> and a selection of eigenvalues, the <a class="el" href="group__starneig__sm__sep.html#ga63f72c90a9911f670610c102029b8ea0" title="Computes an eigenvector for each selected eigenvalue. ">starneig_SEP_SM_Eigenvectors()</a> and <a class="el" href="group__starneig__dm__sep.html#gaa3e495a9ba099cdbc56266d078871b28" title="Computes an eigenvector for each selected eigenvalue. ">starneig_SEP_DM_Eigenvectors()</a> interface functions compute and return an eigenvector for each of the selected eigenvalues.</p>
<p>The eigenvectors are stored as columns in the output matrix <img class="formulaInl" alt="$X$" src="form_7.png"/> in the same order as their corresponding eigenvalues appear in the selection array. A real eigenvector is stored as a single column. The real and imaginary parts of a complex eigenvector are stored as consecutive columns.</p>
<p>For a selected pair of complex conjugate eigenvalues, an eigenvector is computed only for the eigenvalue with positive imaginary part. Thus, every selected eigenvalue contributes one column to the output matrix and thus the number of selected eigenvalues is equal to the number of columns of <img class="formulaInl" alt="$X$" src="form_7.png"/>.</p>
<h2>Eigenvalue selection helper</h2>
<p>Given a Schur matrix and a predicate function, the <a class="el" href="group__starneig__sm__sep.html#ga9d824d76e75f00a2f6a9b0bdc37e159c" title="Generates a selection array for a Schur matrix using a user-supplied predicate function. ">starneig_SEP_SM_Select()</a> and <a class="el" href="group__starneig__dm__sep.html#ga2387379625b60d79ad9ae20ec58ff64a" title="Generates a selection array for a Schur matrix using a user-supplied predicate function. ">starneig_SEP_DM_Select()</a> interface functions conveniently generate a correct selection array and count the number of selected eigenvalues. The count is useful when allocating storage for the eigenvector matrix computed by the <a class="el" href="group__starneig__sm__sep.html#ga63f72c90a9911f670610c102029b8ea0" title="Computes an eigenvector for each selected eigenvalue. ">starneig_SEP_SM_Eigenvectors()</a> and <a class="el" href="group__starneig__dm__sep.html#gaa3e495a9ba099cdbc56266d078871b28" title="Computes an eigenvector for each selected eigenvalue. ">starneig_SEP_DM_Eigenvectors()</a> interface functions.</p>
<div class="fragment"><div class="line"><span class="comment">// a predicate function that selects all eigenvalues that have a real</span></div><div class="line"><span class="comment">// part that is larger than a given value</span></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> predicate(<span class="keywordtype">double</span> real, <span class="keywordtype">double</span> imag, <span class="keywordtype">void</span> *arg)</div><div class="line">{</div><div class="line">    <span class="keywordtype">double</span> value = * (<span class="keywordtype">double</span> *) arg;</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (value &lt; real)</div><div class="line">        <span class="keywordflow">return</span> 1;</div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> func(...)</div><div class="line">{</div><div class="line">    <span class="keywordtype">double</span> *S; <span class="keywordtype">int</span> ldS;</div><div class="line"></div><div class="line">    ...</div><div class="line"></div><div class="line">    <span class="keywordtype">double</span> value = 0.5;</div><div class="line">    <span class="keywordtype">int</span> num_selected, *selected = malloc(n*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line">    <a class="code" href="group__starneig__sm__sep.html#ga9d824d76e75f00a2f6a9b0bdc37e159c">starneig_SEP_SM_Select</a>(</div><div class="line">        n, S, ldS, &amp;predicate, &amp;value, selected, &amp;num_selected);</div><div class="line"></div><div class="line">    ...</div><div class="line">}</div></div><!-- fragment --><p>See modules <a class="el" href="group__starneig__sm__sep.html">Shared Memory / Standard EVP</a> and <a class="el" href="group__starneig__dm__sep.html">Distributed Memory / Standard EVP</a> for further information. See also examples <a class="el" href="sep_sm_full_chain_8c-example.html">sep_sm_full_chain.c</a>, <a class="el" href="sep_dm_full_chain_8c-example.html">sep_dm_full_chain.c</a> and <a class="el" href="sep_sm_eigenvectors_8c-example.html">sep_sm_eigenvectors.c</a>. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
