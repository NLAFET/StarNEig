<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>StarNEig Library: Generalized eigenvalue problem</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="nlafet-transparent.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">StarNEig Library
   &#160;<span id="projectnumber">version v0.1-beta.1</span>
   </div>
   <div id="projectbrief">A task-based library for solving nonsymmetric eigenvalue problems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md__5_generalized.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Generalized eigenvalue problem </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The library provides 12 interface functions for the generalized case:</p>
<h2>Hessenberg-triangular reduction</h2>
<p>Given a general matrix <img class="formulaInl" alt="$(A,B)$" src="form_88.png"/>, the <a class="el" href="group__starneig__sm__gep.html#ga5eb861dd4c09a92cb0c2bab0e4c6f165" title="Computes a Hessenberg-triangular decomposition of a general matrix pencil. ">starneig_GEP_SM_HessenbergTriangular()</a> and <a class="el" href="group__starneig__dm__gep.html#ga864e04d38e72ebbb06bc4a7558a7a3e1" title="Computes a Hessenberg-triangular decomposition of a general matrix pencil. ">starneig_GEP_DM_HessenbergTriangular()</a> interface functions compute a Hessenberg-triangular decomposition </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ (A,B) = U_1 * (H,T) * U_2^T, \]" src="form_89.png"/>
</p>
<p> where <img class="formulaInl" alt="$H$" src="form_2.png"/> is upper Hessenberg, <img class="formulaInl" alt="$T$" src="form_11.png"/> is upper triangular, and <img class="formulaInl" alt="$U_1$" src="form_90.png"/> and <img class="formulaInl" alt="$U_2$" src="form_91.png"/> are orthogonal. On exit, <img class="formulaInl" alt="$A$" src="form_0.png"/> is overwritten by <img class="formulaInl" alt="$H$" src="form_2.png"/>, <img class="formulaInl" alt="$B$" src="form_9.png"/> is overwritten by <img class="formulaInl" alt="$T$" src="form_11.png"/>, and <img class="formulaInl" alt="$Q$" src="form_1.png"/> and <img class="formulaInl" alt="$Z$" src="form_10.png"/> (which are orthogonal matrices on entry) are overwritten by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ Q \gets Q * U_1 \text{ and } Z \gets Z * U_2. \]" src="form_92.png"/>
</p>
<h2>Generalized Schur reduction</h2>
<p>Given a Hessenberg-triangular decomposition </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ (A,B) = Q * (H,T) * Z^T \]" src="form_93.png"/>
</p>
<p> of a general matrix pencil <img class="formulaInl" alt="$(A,B)$" src="form_88.png"/>, the <a class="el" href="group__starneig__sm__gep.html#ga585238746f86747b730f5c8d401ac026" title="Computes a generalized Schur decomposition given a Hessenberg-triangular decomposition. ">starneig_GEP_SM_Schur()</a> and <a class="el" href="group__starneig__dm__gep.html#gab76050cfb98ba88854371ed05be7dc58" title="Computes a generalized Schur decomposition given a Hessenberg-triangular decomposition. ">starneig_GEP_DM_Schur()</a> interface functions function compute a generalized Schur decomposition </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ (A,B) = Q * ( U_1 * (S,\hat{T}) * U_2^T ) * Z^T, \]" src="form_94.png"/>
</p>
<p> where <img class="formulaInl" alt="$S$" src="form_4.png"/> is upper quasi-triangular with <img class="formulaInl" alt="$1 \times 1$" src="form_35.png"/> and <img class="formulaInl" alt="$2 \times 2$" src="form_6.png"/> blocks on the diagonal, <img class="formulaInl" alt="$\hat{T}$" src="form_14.png"/> is a upper triangular matrix, and <img class="formulaInl" alt="$U_1$" src="form_90.png"/> and <img class="formulaInl" alt="$U_2$" src="form_91.png"/> are orthogonal.</p>
<p>On exit, <img class="formulaInl" alt="$H$" src="form_2.png"/> is overwritten by <img class="formulaInl" alt="$S$" src="form_4.png"/>, <img class="formulaInl" alt="$T$" src="form_11.png"/> is overwritten by <img class="formulaInl" alt="$\hat{T}$" src="form_14.png"/>, and <img class="formulaInl" alt="$Q$" src="form_1.png"/> and <img class="formulaInl" alt="$Z$" src="form_10.png"/> are overwritten by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ Q \gets Q * U_1 \text{ and } Z \gets Z * U_2. \]" src="form_92.png"/>
</p>
<p>The computed generalized eigenvalues are returned as a pair of values <img class="formulaInl" alt="$(\alpha,\beta)$" src="form_95.png"/> such that <img class="formulaInl" alt="$\alpha/\beta$" src="form_96.png"/> gives the actual generalized eigenvalue. The quantity <img class="formulaInl" alt="$\alpha/\beta$" src="form_96.png"/> may overflow.</p>
<h2>Generalized eigenvalue reordering</h2>
<p>Given a generalized Schur decomposition </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ (A,B) = Q * (S,T) * Z^T \]" src="form_97.png"/>
</p>
<p> of a general matrix pencil <img class="formulaInl" alt="$(A,B)$" src="form_88.png"/> and a selection of generalized eigenvalues, the <a class="el" href="group__starneig__sm__gep.html#ga7c1fbce46109c1387c7f78d9c8b188e2" title="Reorders selected generalized eigenvalues to the top left corner of a generalized Schur decomposition...">starneig_GEP_SM_ReorderSchur()</a> and <a class="el" href="group__starneig__dm__gep.html#ga07846331814c7b440c33b721410ad62e" title="Reorders selected generalized eigenvalues to the top left corner of a generalized Schur decomposition...">starneig_GEP_DM_ReorderSchur()</a> interface functions attempt to reorder the selected generalized eigenvalues to the top left corner of an updated generalized Schur decomposition by an orthogonal similarity transformation </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ (A,B) = Q * ( U_1 * (\hat{S},\hat{T}) * U_2^T ) * Z^T. \]" src="form_98.png"/>
</p>
<p>On exit, <img class="formulaInl" alt="$S$" src="form_4.png"/> is overwritten by <img class="formulaInl" alt="$\hat{S}$" src="form_5.png"/>, <img class="formulaInl" alt="$T$" src="form_11.png"/> is overwritten by <img class="formulaInl" alt="$\hat{T}$" src="form_14.png"/>, and <img class="formulaInl" alt="$Q$" src="form_1.png"/> and <img class="formulaInl" alt="$Z$" src="form_10.png"/> are overwritten by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ Q \gets Q * U_1 \text{ and } Z \gets Z * U_2. \]" src="form_92.png"/>
</p>
<p>Reordering may in rare cases fail. In such cases the output is guaranteed to be a Schur decomposition and all (if any) selected generalized eigenvalues that are correctly placed are marked in the selection array on exit.</p>
<p>Reordering may perturb the generalized eigenvalues and the generalized eigenvalues after reordering are returned. The computed generalized eigenvalues are returned as a pair of values <img class="formulaInl" alt="$(\alpha,\beta)$" src="form_95.png"/> such that <img class="formulaInl" alt="$\alpha/\beta$" src="form_96.png"/> gives the actual generalized eigenvalue. The quantity <img class="formulaInl" alt="$\alpha/\beta$" src="form_96.png"/> may overflow.</p>
<h2>Combined reduction to generalized Schur form and eigenvalue reordering</h2>
<p>Given a general matrix pencil <img class="formulaInl" alt="$(A,B)$" src="form_88.png"/>, the <a class="el" href="group__starneig__sm__gep.html#ga9e27e175a8cc654ba64832ff2fb9d342" title="Computes a (reordered) generalized Schur decomposition given a general matrix pencil. ">starneig_GEP_SM_Reduce()</a> and <a class="el" href="group__starneig__dm__gep.html#ga56de8627462e69a926d2746a657ece65" title="Computes a (reordered) generalized Schur decomposition given a general matrix pencil. ">starneig_GEP_DM_Reduce()</a> interface functions compute a (reordered) generalized Schur decomposition </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ (A,B) = U_1 * (S,T) * U_2^T, \]" src="form_99.png"/>
</p>
<p> where <img class="formulaInl" alt="$S$" src="form_4.png"/> is upper quasi-triangular with <img class="formulaInl" alt="$1 \times 1$" src="form_35.png"/> and <img class="formulaInl" alt="$2 \times 2$" src="form_6.png"/> blocks on the diagonal, <img class="formulaInl" alt="$T$" src="form_11.png"/> is a upper triangular matrix, and <img class="formulaInl" alt="$U_1$" src="form_90.png"/> and <img class="formulaInl" alt="$U_2$" src="form_91.png"/> are orthogonal. Optionally, the interface functions attempt to reorder selected generalized eigenvalues to the top left corner of the generalized Schur decomposition.</p>
<p>On exit, <img class="formulaInl" alt="$A$" src="form_0.png"/> is overwritten by <img class="formulaInl" alt="$S$" src="form_4.png"/>, <img class="formulaInl" alt="$B$" src="form_9.png"/> is overwritten by <img class="formulaInl" alt="$T$" src="form_11.png"/>, and <img class="formulaInl" alt="$Q$" src="form_1.png"/> and <img class="formulaInl" alt="$Z$" src="form_10.png"/> (which are orthogonal matrices on entry) are overwritten by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ Q \gets Q * U_1 \text{ and } Z \gets Z * U_2. \]" src="form_92.png"/>
</p>
<p>The computed generalized eigenvalues are returned as a pair of values <img class="formulaInl" alt="$(\alpha,\beta)$" src="form_95.png"/> such that <img class="formulaInl" alt="$\alpha/\beta$" src="form_96.png"/> gives the actual generalized eigenvalue. The quantity <img class="formulaInl" alt="$\alpha/\beta$" src="form_96.png"/> may overflow.</p>
<p>Reordering may in rare cases fail. In such cases the output is guaranteed to be a Schur-triangular decomposition and all (if any) selected generalized eigenvalues that are correctly placed are marked in the selection array on exit.</p>
<h2>Generalized eigenvectors</h2>
<p>Given a generalized Schur decomposition </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ (A,B) = Q * (S,T) * Z^T \]" src="form_97.png"/>
</p>
<p> of a general matrix pencil <img class="formulaInl" alt="$(A,B)$" src="form_88.png"/> and a selection of generalized eigenvalues, the <a class="el" href="group__starneig__sm__gep.html#ga74739cbe0c292aaaf7c28c9fd383ddcb" title="Computes a generalized eigenvector for each selected generalized eigenvalue. ">starneig_GEP_SM_Eigenvectors()</a> and <a class="el" href="group__starneig__dm__gep.html#ga6c485cd39a58f9b193d7ea6c6b12c1e4" title="Computes a generalized eigenvector for each selected generalized eigenvalue. ">starneig_GEP_DM_Eigenvectors()</a> interface functions compute and return a generalized eigenvector for each of the selected generalized eigenvalues.</p>
<p>The generalized eigenvectors are stored as columns in the output matrix <img class="formulaInl" alt="$X$" src="form_7.png"/> in the same order as their corresponding generalized eigenvalues appear in the selection array. A real generalized eigenvector is stored as a single column. The real and imaginary parts of a complex generalized eigenvector are stored as consecutive columns.</p>
<p>For a selected pair of complex conjugate generalized eigenvalues, a generalized eigenvector is computed only for the generalized eigenvalue with positive imaginary part. Thus, every selected generalized eigenvalue contributes one column to the output matrix and thus the number of selected generalized eigenvalues is equal to the number of columns of <img class="formulaInl" alt="$X$" src="form_7.png"/>.</p>
<h2>Eigenvalue selection helper</h2>
<p>Given a Schur-triangular matrix pencil <img class="formulaInl" alt="$(S,T)$" src="form_67.png"/> and a predicate function, the <a class="el" href="group__starneig__sm__gep.html#gad65f66b44595f836ca67969f974af568" title="Generates a selection array for a Schur-triangular matrix pencil using a user-supplied predicate func...">starneig_GEP_SM_Select()</a> and <a class="el" href="group__starneig__dm__gep.html#ga682740e323e6baf2c4c40f7c38669fe6" title="Generates a selection array for a Schur-triangular matrix pencil using a user-supplied predicate func...">starneig_GEP_DM_Select()</a> interface functions conveniently generate a correct selection array and count the number of selected generalized eigenvalues. The count is useful when allocating storage for the generalized eigenvector matrix computed by <a class="el" href="group__starneig__dm__gep.html#ga6c485cd39a58f9b193d7ea6c6b12c1e4" title="Computes a generalized eigenvector for each selected generalized eigenvalue. ">starneig_GEP_DM_Eigenvectors()</a>.</p>
<div class="fragment"><div class="line"><span class="comment">// a predicate function that selects all finite generalized eigenvalues that</span></div><div class="line"><span class="comment">// have a real part that is larger than a given value</span></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> predicate(<span class="keywordtype">double</span> real, <span class="keywordtype">double</span> imag, <span class="keywordtype">double</span> beta, <span class="keywordtype">void</span> *arg)</div><div class="line">{</div><div class="line">    <span class="keywordtype">double</span> value = * (<span class="keywordtype">double</span> *) arg;</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (beta != 0.0 &amp;&amp; value &lt; real/beta)</div><div class="line">        <span class="keywordflow">return</span> 1;</div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> func(...)</div><div class="line">{</div><div class="line">    ...</div><div class="line"></div><div class="line">    <span class="keywordtype">double</span> value = 0.5;</div><div class="line">    <span class="keywordtype">int</span> num_selected, *selected = malloc(n*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line">    <a class="code" href="group__starneig__sm__gep.html#gad65f66b44595f836ca67969f974af568">starneig_GEP_SM_Select</a>(</div><div class="line">        n, S, ldS, T, ldT, &amp;predicate, &amp;value, selected, &amp;num_selected);</div><div class="line"></div><div class="line">    ...</div><div class="line">}</div></div><!-- fragment --><p>See modules <a class="el" href="group__starneig__sm__gep.html">Shared Memory / Generalized EVP</a> and <a class="el" href="group__starneig__dm__gep.html">Distributed Memory / Generalized EVP</a> for further information. See also examples <a class="el" href="gep_sm_full_chain_8c-example.html">gep_sm_full_chain.c</a>, <a class="el" href="gep_dm_full_chain_8c-example.html">gep_dm_full_chain.c</a> and <a class="el" href="gep_sm_eigenvectors_8c-example.html">gep_sm_eigenvectors.c</a>. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
