<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>StarNEig Library: Distributed memory</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="nlafet-transparent.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">StarNEig Library
   &#160;<span id="projectnumber">version v0.1-beta.4</span>
   </div>
   <div id="projectbrief">A task-based library for solving nonsymmetric eigenvalue problems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md__3_distributed_memory.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Distributed memory </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The <a class="el" href="group__starneig__node.html#ga3c59d6d34eba90c254f4e34e44700ab4">STARNEIG_HINT_DM</a> initialization flag tells the library to configure itself for distributed memory computation. The flag is indented to be only a hint and the library will automatically reconfigure itself for the correct computation mode. A user is allowed to mix shared memory and distributed memory functions without reninitializing the library. The library is intended to be run in a <b>hybrid configuration</b> (each MPI rank is mapped to several CPU cores). Failing to do so leads to CPU core oversubscription. It is generally a good idea to map each MPI rank to a full node or a NUMA island / CPU socket: </p><div class="fragment"><div class="line"># OpenMPI / one rank per node:</div><div class="line">$ mpirun -n RANKS --map-by ppr:1:node --bind-to none ...</div><div class="line"></div><div class="line"># OpenMPI / one rank per socket:</div><div class="line">$ mpirun -n RANKS --map-by ppr:1:socket --bind-to socket ...</div><div class="line"></div><div class="line"># Intel MPI / one rank per node:</div><div class="line">$ mpirun -n RANKS -binding &quot;pin=on;domain=node&quot; ...</div><div class="line"></div><div class="line"># Intel MPI / one rank per socket:</div><div class="line">$ mpirun -n RANKS -binding &quot;pin=on;domain=socket&quot; ...</div></div><!-- fragment --><dl class="section attention"><dt>Attention</dt><dd>StarPU attempts to bind the worker threads to the available CPU cores. This may sometimes conflict with the MPI library and/or the batch system CPU core allocation. StarNEig library attempts to correct for by factoring in the CPU core binding mask. However, if neither the MPI library nor the batch system enforces such a binding mask, it is possible that several StarPU worker threads end up bound to a same CPU core. In such a situation, it is recommended that a user disables the StarPU thread binding explicitly: <div class="fragment"><div class="line">STARPU_WORKERS_NOBIND=1 mpirun ...</div></div><!-- fragment --> This is particularly important when several ranks / processes are mapped to a same node.</dd></dl>
<p>The library assumes that the MPI library is already initialized when the <a class="el" href="group__starneig__node.html#ga4d6386652685ba5c5706e72ebbb7cb3a" title="Initializes the intra-node execution environment. ">starneig_node_init()</a> interface function is called with the <a class="el" href="group__starneig__node.html#ga3c59d6d34eba90c254f4e34e44700ab4">STARNEIG_HINT_DM</a> flag or when the library reconfigures itself for distributed memory after a user has called a distributed memory interface function. The MPI library should be initialized either in the serialized mode: </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> thread_support;</div><div class="line">MPI_Init_thread(</div><div class="line">    &amp;argc, (<span class="keywordtype">char</span> ***)&amp;argv, MPI_THREAD_SERIALIZED, &amp;thread_support);</div><div class="line"></div><div class="line"><span class="keywordflow">if</span> (thread_support &lt; MPI_THREAD_SERIALIZED) {</div><div class="line">    fprintf(stderr,</div><div class="line">        <span class="stringliteral">&quot;MPI_THREAD_SERIALIZED is not supported. Aborting...\n&quot;</span>);</div><div class="line">    abort();</div><div class="line">}</div></div><!-- fragment --><p> Or in the multi-threaded mode: </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> thread_support;</div><div class="line">MPI_Init_thread(</div><div class="line">    &amp;argc, (<span class="keywordtype">char</span> ***)&amp;argv, MPI_THREAD_MULTIPLE, &amp;thread_support);</div><div class="line"></div><div class="line"><span class="keywordflow">if</span> (thread_support &lt; MPI_THREAD_SERIALIZED) {</div><div class="line">    fprintf(stderr,</div><div class="line">        <span class="stringliteral">&quot;MPI_THREAD_SERIALIZED is not supported. Aborting...\n&quot;</span>);</div><div class="line">    abort();</div><div class="line">} <span class="keywordflow">else</span> <span class="keywordflow">if</span> (thread_support &lt; MPI_THREAD_MULTIPLE) {</div><div class="line">    fprintf(stderr,</div><div class="line">        <span class="stringliteral">&quot;Warning: MPI_THREAD_MULTIPLE is not supported.\n&quot;</span>);</div><div class="line">}</div></div><!-- fragment --><p>A user is allowed to change the library MPI communicator with the <a class="el" href="group__starneig__node.html#ga198baa0b0a4814a3031d855e37b88719" title="Sets a MPI communicator for the library. ">starneig_mpi_set_comm()</a> interface function. This interface function should be called <b>before</b> the library is initialized.</p>
<h2>Data distribution</h2>
<p>Distributed matrices are represented using two opaque objects:</p>
<ul>
<li><em>Data distribution</em> (<a class="el" href="group__starneig__dm__matrix.html#ga752a8405b28dfae3b2c85202887a250d">starneig_distr_t</a>)</li>
<li><em>Distributed matrix</em> (<a class="el" href="group__starneig__dm__matrix.html#gafe12044a51d121d0c3d8544eede44512">starneig_distr_matrix_t</a>)</li>
</ul>
<p>Each matrix is divided into rectangular blocks of uniform size (excluding the last block row and column):</p>
<div class="image">
<object type="image/svg+xml" data="distr_matrix.svg">distr_matrix.svg</object>
<div class="caption">
A matrix divided into rectangular blocks of uniform size.</div></div>
<p>The blocks are indexed using a two-dimensional index space. A data distribution encapsulates an arbitrary mapping from this two-dimensional block index space to the one-dimensional MPI rank space:</p>
<div class="image">
<object type="image/svg+xml" data="distr_matrix2.svg">distr_matrix2.svg</object>
<div class="caption">
An example of a block mapping.</div></div>
<p>In the above example, the rank 0 owns the blocks (0,1), (1,2), (1,5), (1,6), (2,6), (3,0) and (3,5). Naturally, a data distribution can describe a two-dimensional block cyclic distribution that is very common with ScaLAPACK subroutines:</p>
<div class="image">
<object type="image/svg+xml" data="distr_matrix3.svg">distr_matrix3.svg</object>
<div class="caption">
An example of a row-major ordered two-dimensional block cyclic mapping.</div></div>
<p>A data distribution can be created using one of the following interface functions:</p>
<ul>
<li><a class="el" href="group__starneig__dm__matrix.html#gaf2358ba6cd6bdd8a985d17f1f2d75427" title="Creates a default data distribution. ">starneig_distr_init()</a> creates a default distribution (row-major ordered two-dimensional block cyclic distribution with a squarish mesh).</li>
<li><a class="el" href="group__starneig__dm__matrix.html#ga8238518d3fec830454e78c59b561c2d2" title="Creates a two-dimensional block cyclic data distribution. ">starneig_distr_init_mesh()</a> creates a row-major or column-major ordered two-dimensional block cyclic distribution with desired number of rows and columns in the mesh.</li>
<li><a class="el" href="group__starneig__dm__matrix.html#gade87e091936a7aab0c576e278a4b8929" title="Creates a distribution using a data distribution function. ">starneig_distr_init_func()</a> creates an arbitrary distribution defined by a function.</li>
</ul>
<p>Fox example, </p><div class="fragment"><div class="line"><a class="code" href="group__starneig__dm__matrix.html#ga752a8405b28dfae3b2c85202887a250d">starneig_distr_t</a> distr = <a class="code" href="group__starneig__dm__matrix.html#ga8238518d3fec830454e78c59b561c2d2">starneig_distr_init_mesh</a>(4, 6, <a class="code" href="group__starneig__dm__matrix.html#gga5a0f09f962b09e0858bbbc7986e3964aabef644e09e36ecdb49a45aae76dfb147">STARNEIG_ORDER_DEFAULT</a>);</div></div><!-- fragment --><p> would create a two-dimensional block cyclic distribution with 4 rows and 6 columns in the mesh. Alternatively, a user can create an equivalent data distribution using the <a class="el" href="group__starneig__dm__matrix.html#gade87e091936a7aab0c576e278a4b8929" title="Creates a distribution using a data distribution function. ">starneig_distr_init_func()</a> interface function: </p><div class="fragment"><div class="line"><span class="comment">// additional distribution function argument structure</span></div><div class="line"><span class="keyword">struct </span>block_cyclic_arg {</div><div class="line">    <span class="keywordtype">int</span> rows;   <span class="comment">// the number of rows in the process mesh</span></div><div class="line">    <span class="keywordtype">int</span> cols;   <span class="comment">// the number of columns in the process mesh</span></div><div class="line">};</div><div class="line"></div><div class="line"><span class="comment">// distribution function (row-major ordered 2D block cyclic distribution)</span></div><div class="line"><span class="keywordtype">int</span> block_cyclic_func(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">void</span> *arg)</div><div class="line">{</div><div class="line">    <span class="keyword">struct </span>block_cyclic_arg *mesh = (<span class="keyword">struct </span>block_cyclic_arg *) arg;</div><div class="line">    <span class="keywordflow">return</span> (i % mesh-&gt;rows) * mesh-&gt;cols + j % mesh-&gt;cols;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> func(...)</div><div class="line">{</div><div class="line">    ...</div><div class="line"></div><div class="line">    <span class="keyword">struct </span>block_cyclic_arg arg = { .rows = 4, .cols = 6 };</div><div class="line">    <a class="code" href="group__starneig__dm__matrix.html#ga752a8405b28dfae3b2c85202887a250d">starneig_distr_t</a> distr =</div><div class="line">        <a class="code" href="group__starneig__dm__matrix.html#gade87e091936a7aab0c576e278a4b8929">starneig_distr_init_func</a>(&amp;block_cyclic_func, &amp;arg, <span class="keyword">sizeof</span>(arg));</div><div class="line"></div><div class="line">    ...</div><div class="line">}</div></div><!-- fragment --><p>A data distribution is destroyed with the <a class="el" href="group__starneig__dm__matrix.html#ga2a3f59a9521ce7ea0583e75f0b08de67" title="Destroys a data distribution. ">starneig_distr_destroy()</a> interface function.</p>
<dl class="section remark"><dt>Remarks</dt><dd>Certain interface functions (<a class="el" href="group__starneig__dm__sep.html#gab328fae0d50eaab2e35110da6d6812c8" title="Computes a Hessenberg decomposition of a general matrix. ">starneig_SEP_DM_Hessenberg()</a>, <a class="el" href="group__starneig__dm__sep.html#gacda636c9bbb32bb65f03b0797998f1bc" title="Computes a (reordered) Schur decomposition of a general matrix. ">starneig_SEP_DM_Reduce()</a>, <a class="el" href="group__starneig__dm__gep.html#ga864e04d38e72ebbb06bc4a7558a7a3e1" title="Computes a Hessenberg-triangular decomposition of a general matrix pencil. ">starneig_GEP_DM_HessenbergTriangular()</a>, and <a class="el" href="group__starneig__dm__gep.html#ga56de8627462e69a926d2746a657ece65" title="Computes a (reordered) generalized Schur decomposition given a general matrix pencil. ">starneig_GEP_DM_Reduce()</a>) are wrappers for / use several ScaLAPACK subroutines. The involved matrices should thus have a two-dimensional block cyclic data distribution. The library will automatically convert the matrices to a compatible format but this requires extra memory.</dd></dl>
<h2>Distributed matrix</h2>
<p>A distributed matrix is created using the <a class="el" href="group__starneig__dm__matrix.html#ga87b37007fe51519b91f9976197577a8d" title="Creates a distributed matrix with uninitialized matrix elements. ">starneig_distr_matrix_create()</a> interface function. The function call will automatically allocate the required local resources. For example, </p><div class="fragment"><div class="line"><a class="code" href="group__starneig__dm__matrix.html#ga752a8405b28dfae3b2c85202887a250d">starneig_distr_t</a> distr =</div><div class="line">    <a class="code" href="group__starneig__dm__matrix.html#ga8238518d3fec830454e78c59b561c2d2">starneig_distr_init_mesh</a>(4, 6, <a class="code" href="group__starneig__dm__matrix.html#gga5a0f09f962b09e0858bbbc7986e3964aabef644e09e36ecdb49a45aae76dfb147">STARNEIG_ORDER_DEFAULT</a>);</div><div class="line"><a class="code" href="group__starneig__dm__matrix.html#gafe12044a51d121d0c3d8544eede44512">starneig_distr_matrix_t</a> dA =</div><div class="line">    <a class="code" href="group__starneig__dm__matrix.html#ga87b37007fe51519b91f9976197577a8d">starneig_distr_matrix_create</a>(m, n, bm, bn, <a class="code" href="group__starneig__dm__matrix.html#ggad8f668a249453af08e1063acaf6f95c1ac36c6c4ab926ecf1e5cb22c1968971ad">STARNEIG_REAL_DOUBLE</a>, distr);</div></div><!-- fragment --><p> would create a <img class="formulaInl" alt="$m \times n$" src="form_84.png"/> double-precision real matrix that is distributed in a two-dimensional block cyclic fashion in <img class="formulaInl" alt="$bm \times bn$" src="form_85.png"/> blocks. Or, </p><div class="fragment"><div class="line"><a class="code" href="group__starneig__dm__matrix.html#gafe12044a51d121d0c3d8544eede44512">starneig_distr_matrix_t</a> dB =</div><div class="line">    <a class="code" href="group__starneig__dm__matrix.html#ga87b37007fe51519b91f9976197577a8d">starneig_distr_matrix_create</a>(n, n, -1, -1, <a class="code" href="group__starneig__dm__matrix.html#ggad8f668a249453af08e1063acaf6f95c1ac36c6c4ab926ecf1e5cb22c1968971ad">STARNEIG_REAL_DOUBLE</a>, NULL);</div></div><!-- fragment --><p> would create a <img class="formulaInl" alt="$n \times n$" src="form_25.png"/> double-precision real matrix with a default data distribution (<code>NULL</code> argument) and a default block size (<code>-1, -1</code>).</p>
<dl class="section attention"><dt>Attention</dt><dd>StarNEig library is designed to use much larger distributed blocks than ScaLAPACK. Selecting a too small distributed block size will be detrimental to the performance.</dd></dl>
<p>A user may access the locally owned blocks using the <a class="el" href="group__starneig__dm__matrix.html#ga88df5c04d8351cd4f3609aa29072745a" title="Returns the locally owned distributed blocks. ">starneig_distr_matrix_get_blocks()</a> interface function. A distributed matrix is destroyed using the <a class="el" href="group__starneig__dm__matrix.html#gab5e014192e0b468e72802ea8b512848d" title="Destroys a distributed matrix. ">starneig_distr_matrix_destroy()</a> interface function. This will deallocate all local resources. See module <a class="el" href="group__starneig__dm__matrix.html">Distributed Memory / Distributed matrices</a> for further information.</p>
<dl class="section remark"><dt>Remarks</dt><dd>Certain interface functions (<a class="el" href="group__starneig__dm__sep.html#gab328fae0d50eaab2e35110da6d6812c8" title="Computes a Hessenberg decomposition of a general matrix. ">starneig_SEP_DM_Hessenberg()</a>, <a class="el" href="group__starneig__dm__sep.html#gacda636c9bbb32bb65f03b0797998f1bc" title="Computes a (reordered) Schur decomposition of a general matrix. ">starneig_SEP_DM_Reduce()</a>, <a class="el" href="group__starneig__dm__gep.html#ga864e04d38e72ebbb06bc4a7558a7a3e1" title="Computes a Hessenberg-triangular decomposition of a general matrix pencil. ">starneig_GEP_DM_HessenbergTriangular()</a>, and <a class="el" href="group__starneig__dm__gep.html#ga56de8627462e69a926d2746a657ece65" title="Computes a (reordered) generalized Schur decomposition given a general matrix pencil. ">starneig_GEP_DM_Reduce()</a>) are wrappers for / use several ScaLAPACK subroutines. The involved matrices should thus be distributed in square blocks. In addition, the ScaLAPACK subroutines usually perform better when the block size is relatively small. The library will automatically convert the matrices to a compatible format but this requires extra memory.</dd></dl>
<h2>Copy, scatter and gather</h2>
<p>An entire distributed matrix can be copied with the <a class="el" href="group__starneig__dm__matrix.html#ga41cf77e628b68c39142d148cdd5d991e" title="Copies the contents of a distributed matrix to a second distributed matrix. ">starneig_distr_matrix_copy()</a> interface function: </p><div class="fragment"><div class="line"><a class="code" href="group__starneig__dm__matrix.html#gafe12044a51d121d0c3d8544eede44512">starneig_distr_matrix_t</a> dA, dB;</div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line">starneig_distr_matrix_copy(dB, dA);</div></div><!-- fragment --><p> This copies distributed matrix <code>dB</code> to a distributed matrix <code>dA</code>. A region (submatrix) of a distributed matrix can be copied to a second distributed matrix using the <a class="el" href="group__starneig__dm__matrix.html#gaf1db526abd6035841cb8ce3dec6e74a1" title="Copies region of a distributed matrix to a second distributed matrix. ">starneig_distr_matrix_copy_region()</a> interface function.</p>
<p>A local matrix can be converted to a "single owner" distributed matrix with the <a class="el" href="group__starneig__dm__matrix.html#ga4e05c038d2bd44b7757eb4c07bef96dc" title="Creates a single-owner distributed matrix from a local matrix. ">starneig_distr_matrix_create_local()</a> interface function: </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> owner = 0; <span class="comment">// MPI rank that owns the local matrix</span></div><div class="line"><span class="keywordtype">double</span> *A;     <span class="comment">// local pointer</span></div><div class="line"><span class="keywordtype">int</span> ldA;       <span class="comment">// matching leading dimension</span></div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line">starneig_distr_matrix_t lA = <a class="code" href="group__starneig__dm__matrix.html#ga4e05c038d2bd44b7757eb4c07bef96dc">starneig_distr_matrix_create_local</a>(</div><div class="line">    n, n, <a class="code" href="group__starneig__dm__matrix.html#ggad8f668a249453af08e1063acaf6f95c1ac36c6c4ab926ecf1e5cb22c1968971ad">STARNEIG_REAL_DOUBLE</a>, owner, A, ldA);</div></div><!-- fragment --><p> This creates a wrapper object, i.e., the pointer <code>A</code> and the distributed matrix <code>lA</code> point to the same data on the <code>owner</code> node. The created distributed matrix is associated with a data distribution that indicated that the whole matrix is owned by the node <code>owner</code>. The used block size is <img class="formulaInl" alt="$n \times n$" src="form_25.png"/>.</p>
<p>Copying from a "single owner" distributed matrix to a distributed matrix performs a <em>scatter</em> operation and copying from a distributed matrix to a "single owner" distributed matrix performs a <em>gather</em> operation.</p>
<h2>ScaLAPACK compatibility layer</h2>
<p>The library provides a ScaLAPACK compatibility layer:</p>
<ul>
<li>BLACS contexts are encapsulated inside <a class="el" href="group__starneig__dm__blacs.html#ga2610a78a74c6216e26c710b0d319edcd">starneig_blacs_context_t</a> objects.</li>
<li>BLACS descriptors are encapsulated inside <a class="el" href="group__starneig__dm__blacs.html#gabcf5b33ca3e471ca6ffe50e6c1e8e790">starneig_blacs_descr_t</a> objects.</li>
</ul>
<p>A two-dimensional block cyclic data distribution can be converted to a BLACS context and vice versa using the <a class="el" href="group__starneig__dm__blacs.html#ga358e78f5506447151ab45ffea61bc2a2" title="Convers a data distribution to a BLACS context. ">starneig_distr_to_blacs_context()</a> and <a class="el" href="group__starneig__dm__blacs.html#ga1f0b0bcb78e17be5921edeb10213be43" title="Convers a BLACS context to a data distribution. ">starneig_blacs_context_to_distr()</a> interface functions, respectively. Similarly, a distributed matrix that uses a two-dimensional block cyclic data distribution can be converted to a BLACS descriptor (and a local buffer) and vice versa using the <a class="el" href="group__starneig__dm__blacs.html#ga55b5ea5e908657c0db6e8c98a958e59d" title="Convers a distributed matrix to a BLACS descriptor and a matching local array. ">starneig_distr_matrix_to_blacs_descr()</a> and <a class="el" href="group__starneig__dm__blacs.html#ga239d4a160b7e28cb17766b30ca27736d" title="Convers a BLACS descriptor and a matching local array to a distributed matrix. ">starneig_blacs_descr_to_distr_matrix()</a> interface functions, respectively. The conversion is performed in-place and a user is allowed to mix StarNEig interface functions with ScaLAPACK style subroutines/functions without reconversion.</p>
<p>For example, </p><div class="fragment"><div class="line"><a class="code" href="group__starneig__dm__matrix.html#gafe12044a51d121d0c3d8544eede44512">starneig_distr_matrix_t</a> dA = <a class="code" href="group__starneig__dm__matrix.html#ga87b37007fe51519b91f9976197577a8d">starneig_distr_matrix_create</a>(...);</div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line"><span class="comment">// convert the data distribution to a BLACS context</span></div><div class="line">starneig_distr_t distr = <a class="code" href="group__starneig__dm__matrix.html#ga0ee931a54b3482a3dadd6978d95613a1">starneig_distr_matrix_get_distr</a>(A);</div><div class="line"><a class="code" href="group__starneig__dm__blacs.html#ga2610a78a74c6216e26c710b0d319edcd">starneig_blacs_context_t</a> context = <a class="code" href="group__starneig__dm__blacs.html#ga358e78f5506447151ab45ffea61bc2a2">starneig_distr_to_blacs_context</a>(distr);</div><div class="line"></div><div class="line"><span class="comment">// convert the distributed matrix to a BLACS descriptor and a local buffer</span></div><div class="line"><a class="code" href="group__starneig__dm__blacs.html#structstarneig__blacs__descr">starneig_blacs_descr_t</a> descr_a;</div><div class="line"><span class="keywordtype">double</span> *local_a;</div><div class="line"><a class="code" href="group__starneig__dm__blacs.html#ga55b5ea5e908657c0db6e8c98a958e59d">starneig_distr_matrix_to_blacs_descr</a>(dA, context, &amp;descr_a, (<span class="keywordtype">void</span> **)&amp;local_a);</div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line"><span class="comment">// a ScaLAPACK subroutine for reducing general distributed matrix to upper</span></div><div class="line"><span class="comment">// Hessenberg form</span></div><div class="line">extern <span class="keywordtype">void</span> pdgehrd_(<span class="keywordtype">int</span> <span class="keyword">const</span> *, <span class="keywordtype">int</span> <span class="keyword">const</span> *, <span class="keywordtype">int</span> <span class="keyword">const</span> *, <span class="keywordtype">double</span> *,</div><div class="line">    <span class="keywordtype">int</span> <span class="keyword">const</span> *, <span class="keywordtype">int</span> <span class="keyword">const</span> *, <a class="code" href="group__starneig__dm__blacs.html#structstarneig__blacs__descr">starneig_blacs_descr_t</a> <span class="keyword">const</span> *, <span class="keywordtype">double</span> *,</div><div class="line">    <span class="keywordtype">double</span> *, <span class="keywordtype">int</span> <span class="keyword">const</span> *, <span class="keywordtype">int</span> *);</div><div class="line"></div><div class="line">pdgehrd_(&amp;n, &amp;ilo, &amp;ihi, local_a, &amp;ia, &amp;ja, &amp;descr_a, tau, ...);</div></div><!-- fragment --><p> converts a distributed matrix <code>dA</code> to a BLACS descriptor <code>descr_a</code> and a local pointer <code>local_a</code>. The descriptor and the local array are then fed to a ScaLAPACK subroutine. A user must make sure that the live time of the distributed matrix <code>dA</code> is at least as long as the live time of the matching BLACS descriptor <code>descr_a</code>. See modules <a class="el" href="group__starneig__dm__blacs__helpers.html">ScaLAPACK compatibility / BLACS helpers</a> and <a class="el" href="group__starneig__dm__blacs.html">ScaLAPACK compatibility / BLACS matrices</a> for further information. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
