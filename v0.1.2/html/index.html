<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>StarNEig Library: Introduction</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">StarNEig Library
   &#160;<span id="projectnumber">v0.1.2</span>
   </div>
   <div id="projectbrief">A task-based library for solving dense nonsymmetric eigenvalue problems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Introduction </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>StarNEig library aims to provide a complete task-based software stack for solving <b>dense</b> <b>nonsymmetric</b> (generalized) eigenvalue problems. The library is built on top of the <a href="http://starpu.gforge.inria.fr/">StarPU</a> runtime system and targets both shared memory and distributed memory machines. Some components of the library support GPUs.</p>
<p>The four main components of the library are:</p>
<ul>
<li><b>Hessenberg(-triangular) reduction</b>: A dense matrix (or a dense matrix pair) is reduced to upper Hessenberg (or Hessenberg-triangular) form.</li>
<li><b>Schur reduction (QR/QZ algorithm)</b>: A upper Hessenberg matrix (or a Hessenberg-triangular matrix pair) is reduced to (generalized) Schur form. The (generalized) eigenvalues can be determined from the diagonal blocks.</li>
<li><b>Eigenvalue reordering</b>: Reorders a user-selected set of (generalized) eigenvalues to the upper left corner of an updated (generalized) Schur form.</li>
<li><b>Eigenvectors</b>: Computes (generalized) eigenvectors for a user-selected set of (generalized) eigenvalues.</li>
</ul>
<p><b>A brief summary of the StarNEig library</b> can be found from a recent poster: <em>Task-based, GPU-accelerated and Robust Algorithms for Solving Dense Nonsymmetric Eigenvalue Problems</em>, Swedish eScience Academy, Lund, Sweden, October 15-16, 2019 (<a href="http://www.nlafet.eu/starneig/escience_poster.pdf">download</a>)</p>
<p>The library has been developed as a part of the NLAFET project. The project has received funding from the European Union’s Horizon 2020 research and innovation programme under grant agreement No. 671633. Support has also been received from eSSENCE, a collaborative e-Science programme funded by the Swedish Government via the Swedish Research Council (VR), and VR Grant E0485301.</p>
<p>The library is open source and published under BSD 3-Clause license.</p>
<p>Please cite the following article when refering to StarNEig: </p><blockquote class="doxtable">
<p>Mirko Myllykoski, Carl Christian Kjelgaard Mikkelsen: <em>Introduction to StarNEig — A Task-based Library for Solving Nonsymmetric Eigenvalue Problems</em>, In Parallel Processing and Applied Mathematics, 13th International Conference, PPAM 2019, Bialystok, Poland, September 8–11, 2019, Revised Selected Papers, Part I, Lecture Notes in Computer Science, Vol. 12043, Wyrzykowski R., Deelman E., Dongarra J., Karczewski K. (eds), Springer International Publishing, pp. 70-81, 2020, doi: <a href="https://doi.org/10.1007/978-3-030-43229-4_7">10.1007/978-3-030-43229-4_7</a> </p>
</blockquote>
<p>Please see publications and authors.</p>
<h2>Current status (stable series)</h2>
<p>The library currently supports only real arithmetic (real input and output matrices but real and/or complex eigenvalues and eigenvectors). In addition, some interface functions are implemented as LAPACK and ScaLAPACK wrapper functions.</p>
<p>Standard eigenvalue problems:</p>
<table class="doxtable">
<tr>
<th>Component </th><th align="center">Shared memory </th><th align="center">Distributed memory </th><th align="center">CUDA  </th></tr>
<tr>
<td>Hessenberg reduction </td><td align="center"><b>Complete</b> </td><td align="center">ScaLAPACK </td><td align="center"><b>Single GPU</b> </td></tr>
<tr>
<td>Schur reduction </td><td align="center"><b>Complete</b> </td><td align="center"><b>Complete</b> </td><td align="center"><em>Experimental</em> </td></tr>
<tr>
<td>Eigenvalue reordering </td><td align="center"><b>Complete</b> </td><td align="center"><b>Complete</b> </td><td align="center"><em>Experimental</em> </td></tr>
<tr>
<td>Eigenvectors </td><td align="center"><b>Complete</b> </td><td align="center">&mdash; </td><td align="center">&mdash; </td></tr>
</table>
<p>Generalized eigenvalue problems:</p>
<table class="doxtable">
<tr>
<th>Component </th><th align="center">Shared memory </th><th align="center">Distributed memory </th><th align="center">CUDA  </th></tr>
<tr>
<td>HT reduction </td><td align="center">LAPACK </td><td align="center">3rd party </td><td align="center">&mdash; </td></tr>
<tr>
<td>Schur reduction </td><td align="center"><b>Complete</b> </td><td align="center"><b>Complete</b> </td><td align="center"><em>Experimental</em> </td></tr>
<tr>
<td>Eigenvalue reordering </td><td align="center"><b>Complete</b> </td><td align="center"><b>Complete</b> </td><td align="center"><em>Experimental</em> </td></tr>
<tr>
<td>Eigenvectors </td><td align="center"><b>Complete</b> </td><td align="center">&mdash; </td><td align="center">&mdash; </td></tr>
</table>
<p>Please see changelog and known problems.</p>
<h2>Documentation:</h2>
<p>HTML and PDF documentation can be found from <a href="https://nlafet.github.io/StarNEig">https://nlafet.github.io/StarNEig</a> and under <a href="https://github.com/NLAFET/StarNEig/releases">releases</a>.</p>
<h2>Quickstart guide</h2>
<h3>Dependencies</h3>
<p>Library dependencies:</p>
<ul>
<li>Linux</li>
<li>CMake 3.3 or newer</li>
<li>Portable Hardware Locality (hwloc)</li>
<li>Starpu 1.2 or 1.3<ul>
<li>Newer versions require the user set the <code>STARPU_LIBRARIES</code>, <code>STARPU_MPI_LIBRARIES</code> and <code>STARPU_INCLUDE_PATH</code> environmental variables.</li>
</ul>
</li>
<li>OpenBLAS, MKL, GotoBLAS or single-threaded BLAS library</li>
<li>LAPACK</li>
<li>MPI (optional)</li>
<li>CUDA + cuBLAS (optional)</li>
<li>ScaLAPACK + BLACS (optional)</li>
</ul>
<p>Test program and example code dependencies:</p>
<ul>
<li>pkg-config</li>
<li>GNU Scientific Library (optional)</li>
<li>MAGMA (optional)</li>
</ul>
<h3>Configure, build and install</h3>
<p>Execute in the same directory as this <code>README.md</code> file: </p><div class="fragment"><div class="line">$ mkdir build</div><div class="line">$ cd build/</div><div class="line">$ cmake ../</div><div class="line">$ make</div><div class="line">$ make test</div><div class="line">$ sudo make install</div></div><!-- fragment --><h3>Example</h3>
<p>The following example demonstrates how a dense matrix <code>A</code> is reduced to real Schur form:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="starneig_8h.html">starneig/starneig.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;time.h&gt;</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main()</div><div class="line">{</div><div class="line">    <span class="keywordtype">int</span> n = 3000;</div><div class="line">    srand((<span class="keywordtype">unsigned</span>) time(NULL));</div><div class="line"></div><div class="line">    <span class="comment">// generate a random matrix A</span></div><div class="line">    <span class="keywordtype">int</span> ldA = ((n/8)+1)*8;</div><div class="line">    <span class="keywordtype">double</span> *A = malloc(n*ldA*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; n; j++)</div><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; i++)</div><div class="line">            A[j*ldA+i] = C[j*ldC+i] = 2.0*rand()/RAND_MAX - 1.0;</div><div class="line"></div><div class="line">    <span class="comment">// generate an identity matrix Q</span></div><div class="line">    <span class="keywordtype">int</span> ldQ = ((n/8)+1)*8;</div><div class="line">    <span class="keywordtype">double</span> *Q = malloc(n*ldA*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; n; j++)</div><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; i++)</div><div class="line">            Q[j*ldQ+i] = i == j ? 1.0 : 0.0;</div><div class="line"></div><div class="line">    <span class="comment">// allocate space for the eigenvalues</span></div><div class="line">    <span class="keywordtype">double</span> *real = malloc(n*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line">    <span class="keywordtype">double</span> *imag = malloc(n*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"></div><div class="line">    <span class="comment">// initialize the StarNEig library</span></div><div class="line">    <a class="code" href="group__starneig__node.html#ga4d6386652685ba5c5706e72ebbb7cb3a">starneig_node_init</a>(-1, -1, <a class="code" href="group__starneig__node.html#ga696b10750293e8b49bda0c205ed0882e">STARNEIG_HINT_SM</a>);</div><div class="line"></div><div class="line">    <span class="comment">// reduce matrix A to real Schur form S = Q^T A Q</span></div><div class="line">    <a class="code" href="group__starneig__sm__sep.html#ga8e038624fecd9f1abb604bef3eb56d3b">starneig_SEP_SM_Reduce</a>(</div><div class="line">        n, A, ldA, Q, ldQ, real, imag, NULL, NULL, NULL, NULL);</div><div class="line"></div><div class="line">    <span class="comment">// de-initialize the StarNEig library</span></div><div class="line">    <a class="code" href="group__starneig__node.html#gad4c8101c0864588743c486cbd8e75dea">starneig_node_finalize</a>();</div><div class="line"></div><div class="line">    free(A); free(Q); free(real); free(imag);</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
